<!DOCTYPE html>
<html>
<head>
	<title>Overdose Web Map</title>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" />
	<link href="styles.css" rel="stylesheet">
</head>
<body>
	<div id="wrapper">
		<div id="header">
			<h1>Overdose & Health Sites in Washington</h1>
		</div>
		<div id="map"></div>
	</div>
	<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script>
    // Create map object
    var map = L.map('map',{ center: [47.7511, -120.7401], zoom: 6 });

    // Add tile layer
		L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}{r}.png', {
			attribution: 'Tiles by <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
			maxZoom: 15,
			minZoom: 5
		}).addTo(map);

	// Null variable that will hold health sites data
	var healthsites = null;

	// Add GeoJSON data to the map when it loads
	$.getJSON("data/healthsites_wa.geojson",function(data){
		// Set health sites to the dataset and add the healthsites GeoJSON layer to the map
		healthsites = L.geoJson(data,{
			onEachFeature: function (feature, layer) {
				layer.bindPopup('Type: '+feature.properties.amenity+'<br>Name: '+feature.properties.name+'<br>City: '+feature.properties.city+'');
      }, pointToLayer: function (feature, latlng) {
        if (feature.properties.amenity == "Hospital"){ 
          var marker = L.marker(latlng,{icon: hospitalIcon});
        } else {
          var marker = L.marker(latlng,{icon: emsIcon});
        };
      return marker;
      }
    }).addTo(map);
});

    // Create standard icon
    var healthIcon = L.Icon.extend({ 
    options:{
        iconUrl: 'icons/hospital.png',
        iconSize: [24,24],
        iconAnchor: [12,12],
        popupAnchor: [0,-6]
    }
    });

    // Create different icons for amenity types
    var hospitalIcon = new healthIcon({iconUrl: 'icons/hospital.png'});
    var emsIcon = new healthIcon({iconUrl: 'icons/ambulance.png'});
    
	</script>
</body>
</html>